

//--------------------------
// Alert
Table Alert {
  id varchar [pk]
  created_at varchar [not null]
  alert_type alert_alert_type [not null]
  camera varchar [ref: > Camera.id]
  external_frame_id varchar [not null]
  external_model_decision_id varchar [not null]
  external_model_prediction_id varchar [not null]
  video_url varchar 
  video_status alert_video_status [not null]
  Indexes {
    external_frame_id [unique]
  }
}
Enum alert_alert_type {
    thief
    suspect_behaviour
}
Enum alert_video_status {
    generation_started
    generation_successed
    video_available
    video_deleted
}

//--------------------------
// Alert Feedback
Table AlertFeedback {
  id varchar [pk]
  created_at datetime [not null, default: `now()`]
  type alert_feedback_type 
  qualification alert_feedback_qualification 
  is_archived integer [not null]
  is_pertinent varchar 
  rate integer 
  rate_anotation varchar 
  alert varchar [ref: > Alert.id]
  user varchar [ref: > User.id]
}
Enum alert_feedback_type {
    suspect_behaviour
    thief
    false_alert
}
Enum alert_feedback_qualification {
    nothing_suspect
    suspect_behaviour
    dissuasion
    stopped
    unstopped
}

//--------------------------
// Camera
Table Camera {
  id varchar [pk]
  created_at datetime [not null, default: `now()`]
  external_id varchar [not null]
  shop_section varchar [ref: > ShopSection.id]
  Indexes {
    external_id [unique]
  }
}

//--------------------------
// Camera Status
Table CameraStatus {
  id varchar [pk]
  created_at datetime [not null, default: `now()`]
  status camera_status_status [not null]
  camera varchar [ref: > Camera.id]
}
Enum camera_status_status {
    ok
    corrupted
    reloading
    out
}

//--------------------------
// Client
Table Client {
  id varchar [pk]
  created_at datetime [not null, default: `now()`]
  name varchar [not null]
  siret varchar [not null]
  adresse varchar [not null]
  raison_social varchar [not null]
  Indexes {
    siret [unique]
  }
}

//--------------------------
// Item Category
Table ItemCategory {
  id varchar [pk]
  created_at datetime [not null, default: `now()`]
  name varchar [not null]
  average_price integer [not null]
  Indexes {
    name [unique]
  }
}

//--------------------------
// Shop
Table Shop {
  id varchar [pk]
  created_at datetime [not null, default: `now()`]
  name varchar [not null]
  client varchar [ref: > Client.id]
  kpis shop_kpis [not null]
}
Enum shop_kpis {
    kpi1
    kpi2
}

//--------------------------
// Shop Department
Table ShopDepartment {
  id varchar [pk]
  created_at datetime [not null, default: `now()`]
  name varchar 
  shop varchar [ref: > Shop.id]
}

//--------------------------
// Shop Section
Table ShopSection {
  id varchar [pk]
  created_at datetime [not null, default: `now()`]
  name varchar [not null]
  shop_departement varchar [ref: > ShopDepartment.id]
  item_category varchar [ref: > ItemCategory.id]
  thief_average_price integer [not null]
}

//--------------------------
// User
Table User {
  id varchar [pk]
  created_at datetime [not null, default: `now()`]
  name varchar [not null]
  email varchar [not null]
  password varchar [not null]
  roles user_roles [not null]
  Indexes {
    email [unique]
  }
}
// Many-to-many for User.shops
Table User_Shops {
    id integer [pk, increment]
    user varchar [ref: > User.id]
    shop varchar [ref: > Shop.id]
}
Enum user_roles {
    admin
    user
    guest
}
